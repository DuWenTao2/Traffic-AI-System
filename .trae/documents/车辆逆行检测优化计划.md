# 车辆逆行检测优化计划

## 目标

1. 删除过去WRONG\_DIRECTION所代表的进出线交互模式，彻底替换为左中右线的检测方式
2. 去除Wrong\_det中对于进出口线的支持代码，减少冗余
3. 将左中右三条线合并到一个按钮交互下执行，即按下3号键开始绘制左边线，然后右键停止，绘制中间线，最后右边线

## 实施步骤

### 1. 修改 areas.py

* **修改3号键功能**：将3号键从设置WRONG\_DIRECTION改为启动左中右车道线绘制流程

* **实现绘制状态机**：添加状态跟踪，记录当前正在绘制的车道线类型（左、中、右）

* **修改鼠标回调**：支持连续绘制三条车道线，右键完成当前车道线并自动切换到下一条

* **更新UI提示**：在绘制过程中显示当前正在绘制的车道线类型

* **移除WRONG\_DIRECTION相关代码**：从AreaType枚举、颜色配置、键盘快捷键等中移除

### 2. 修改 wrong\_det.py

* **删除进出口线相关代码**：移除`configure_line_pairs`、`_get_wrong_direction_lines`、`_create_line_pairs`等方法

* **简化process\_frame**：只处理多车道线检测逻辑

* **移除相关状态跟踪**：删除`vehicle_direction_status`、`line_pairs`等与进出口线相关的变量

* **优化配置逻辑**：只保留`configure_lane_lines`相关的配置方法

### 3. 修改 VideoProcessorMP.py

* **更新逆向检测配置**：不再尝试配置进出口线对，只检查左中右车道线

* **简化检测逻辑**：移除所有与WRONG\_DIRECTION相关的检查和配置

* **更新状态显示**：修改相关的状态信息和日志输出

### 4. 测试验证

* **功能测试**：验证左中右车道线的绘制流程是否正常

* **检测测试**：验证车辆逆行检测是否基于新的车道线算法正常工作

## 预期效果

* 简化的用户交互：按下3号键后连续绘制三条车道线

* 更清晰的代码结构：移除冗余的进出口线支持代码

* 保持检测性能：基于左中右车道线的检测算法能够准确识别逆行车辆

* 更好的可维护性：代码结构更清晰，易于后续调整和扩展

## 技术要点

* 使用状态机管理车道线绘制流程

* 保持与现有多车道线检测算法的兼容性

* 确保所有相关文件的修改保持一致性

* 避免破坏其他功能的正常运行

